<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Курсы ЦБ</title>
</head>
<body>
    <h2>Курсы валют ЦБ РФ</h2>
    <div id="rates">Загрузка...</div>

    <script>
        async function loadRates() {
            try {
                const response = await fetch(
                    "https://api.allorigins.win/raw?url=https://www.cbr.ru/scripts/XML_daily.asp"
                );
                const text = await response.text();

                const parser = new DOMParser();
                const xml = parser.parseFromString(text, "text/xml");

                function getRate(code) {
                    const valutes = xml.getElementsByTagName("Valute");
                    for (let valute of valutes) {
                        if (valute.getElementsByTagName("CharCode")[0].textContent === code) {
                            let value = valute.getElementsByTagName("Value")[0].textContent;
                            let nominal = valute.getElementsByTagName("Nominal")[0].textContent;
                            return (parseFloat(value.replace(",", ".")) / parseFloat(nominal)).toFixed(2);
                        }
                    }
                    return "не найдено";
                }

                const usd = getRate("USD");
                const eur = getRate("EUR");
                const cny = getRate("CNY");

                document.getElementById("rates").innerHTML = `
                    1 USD = ${usd} ₽ <br>
                    1 EUR = ${eur} ₽ <br>
                    1 CNY = ${cny} ₽
                `;

            } catch (error) {
                document.getElementById("rates").innerText = "Ошибка загрузки";
            }
        }

        loadRates();
    </script>
</body>
</html>
